<div class="creator">
    <div id="header">
        <input name="title" class="input" [(ngModel)]="show.title" type="text" 
         placeholder="Show Title" (ngModelChange)="isSaved=false">

        <div>
            <button id="save" class="btn primary" [disabled]="isSaved || !show.title.trim()" 
            (click)="saveShow()">
                Save
                <ng-container [ngTemplateOutlet]="save"></ng-container>
            </button>

            <button id="Export" class="btn primary" [disabled]="true">
                Export
                <ng-container [ngTemplateOutlet]="export"></ng-container>
            </button>
        </div>
    </div>

    
     <div class="scene">
        <ng-container *ngIf="currScene then sceneTabs; else noScene"></ng-container>
    </div>

    <div class="scene-list">
        <div>
            <p class="title">Scenes</p>
            <button class="btn primary" (click)="newScene()">Add Scene</button>
        </div>

        <creator-scene-list 
        [scenes]="show.scenes"
        (deleteClickedEvent)="onDelete($event)">
        </creator-scene-list>
    </div>
</div>



<ng-template #sceneTabs>
    <div class="scene-title">
        <input name="title" type="text" class="bare title" 
         [(ngModel)]="currScene!.title" (ngModelChange)="isSaved=false"
         placeholder="Scene Title">
        <ng-container [ngTemplateOutlet]="x"></ng-container>
    </div>

    <div class="tabs">
        <div class="tab" (click)="tabIdx=0" [class.active]="tabIdx===0">
            <p>Position</p>
        </div>
        <div class="tab" (click)="tabIdx=1" [class.active]="tabIdx===1">
            <p>Options</p>
        </div>
        <div class="tab" (click)="tabIdx=2" [class.active]="tabIdx===2">
            <p>Transition</p>
        </div>
        <div class="tab" (click)="tabIdx=3" [class.active]="tabIdx===3">
            <p>Script</p>
        </div>
    </div>

    
    <div class="content-area">

        <scene-position id="scene-pos"
        *ngIf="tabIdx===0"
        [isAutoMode]="isAutoMode"
        [(ngModel)]="currScene!.geoPos"
        (ngModelChange)="onChange()">
        </scene-position>

        <scene-options 
        *ngIf="tabIdx===1"
        [(ngModel)]="currScene!.sceneOptions"
        (ngModelChange)="onChange()">
        </scene-options>

        <div class="transition"
        *ngIf="tabIdx===2">
            <p>How long it takes OpenSpace to fly to the selected target</p>
            <input
            [formControl]="transitionControl"
            type="text" 
            class="input" 
            placeholder="Transition Duration"
            name="transistion" id="transition"/>
            <p class="error" *ngIf="!transitionControl.valid">
                The field is digits only
            </p>
        </div>
            
        <textarea
        *ngIf="tabIdx===3"
         id="script"
         cols="30"
         rows="20"
         class="input" [(ngModel)]="currScene!.script" 
         placeholder="Script Text"></textarea>

    </div>

    <div id="options">
        <button id="clear">Clear All</button>
        <button id="save" class="btn secondary" 
        (click)="saveScene()"
        [disabled]="!currScene!.title.trim()">Save</button>
    </div>
</ng-template>


<ng-template #noScene>
    <div id="no-scene">
        <h1>No Scene Selected</h1>
    </div>
</ng-template>

<ng-template #meta>
    <div class="details">
        <h1>Show Details</h1>

        <form [formGroup]="detailsForm">
            <div class="section">
                <label for="desc">Script <span>(Optional)</span></label>
                <textarea formControlName="desc" name="desc" id="description" class="input" rows="10"
                    placeholder="Scene Script"></textarea>
            </div>
        </form>
    </div>
</ng-template>

<ng-template #save>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-save">
        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
        <polyline points="17 21 17 13 7 13 7 21"></polyline>
        <polyline points="7 3 7 8 15 8"></polyline>
    </svg>
</ng-template>

<ng-template #export>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-upload">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="17 8 12 3 7 8"></polyline>
        <line x1="12" y1="3" x2="12" y2="15"></line>
    </svg>
</ng-template>

<ng-template #x>
    <svg (click)="currScene!.title=''" id="x" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
        stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
    </svg>
</ng-template>